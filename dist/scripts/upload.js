"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports)))module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;try{e=window}catch(t){e=self}e.SparkMD5=t()}}(function(t){function e(t,e,n,r,a,i){return e=S(S(e,t),S(r,i)),S(e<<a|e>>>32-a,n)}function n(t,n,r,a,i,o,s){return e(n&r|~n&a,t,n,i,o,s)}function r(t,n,r,a,i,o,s){return e(n&a|r&~a,t,n,i,o,s)}function a(t,n,r,a,i,o,s){return e(n^r^a,t,n,i,o,s)}function i(t,n,r,a,i,o,s){return e(r^(n|~a),t,n,i,o,s)}function o(t,e){var o=t[0],s=t[1],u=t[2],f=t[3];o=n(o,s,u,f,e[0],7,-680876936),f=n(f,o,s,u,e[1],12,-389564586),u=n(u,f,o,s,e[2],17,606105819),s=n(s,u,f,o,e[3],22,-1044525330),o=n(o,s,u,f,e[4],7,-176418897),f=n(f,o,s,u,e[5],12,1200080426),u=n(u,f,o,s,e[6],17,-1473231341),s=n(s,u,f,o,e[7],22,-45705983),o=n(o,s,u,f,e[8],7,1770035416),f=n(f,o,s,u,e[9],12,-1958414417),u=n(u,f,o,s,e[10],17,-42063),s=n(s,u,f,o,e[11],22,-1990404162),o=n(o,s,u,f,e[12],7,1804603682),f=n(f,o,s,u,e[13],12,-40341101),u=n(u,f,o,s,e[14],17,-1502002290),s=n(s,u,f,o,e[15],22,1236535329),o=r(o,s,u,f,e[1],5,-165796510),f=r(f,o,s,u,e[6],9,-1069501632),u=r(u,f,o,s,e[11],14,643717713),s=r(s,u,f,o,e[0],20,-373897302),o=r(o,s,u,f,e[5],5,-701558691),f=r(f,o,s,u,e[10],9,38016083),u=r(u,f,o,s,e[15],14,-660478335),s=r(s,u,f,o,e[4],20,-405537848),o=r(o,s,u,f,e[9],5,568446438),f=r(f,o,s,u,e[14],9,-1019803690),u=r(u,f,o,s,e[3],14,-187363961),s=r(s,u,f,o,e[8],20,1163531501),o=r(o,s,u,f,e[13],5,-1444681467),f=r(f,o,s,u,e[2],9,-51403784),u=r(u,f,o,s,e[7],14,1735328473),s=r(s,u,f,o,e[12],20,-1926607734),o=a(o,s,u,f,e[5],4,-378558),f=a(f,o,s,u,e[8],11,-2022574463),u=a(u,f,o,s,e[11],16,1839030562),s=a(s,u,f,o,e[14],23,-35309556),o=a(o,s,u,f,e[1],4,-1530992060),f=a(f,o,s,u,e[4],11,1272893353),u=a(u,f,o,s,e[7],16,-155497632),s=a(s,u,f,o,e[10],23,-1094730640),o=a(o,s,u,f,e[13],4,681279174),f=a(f,o,s,u,e[0],11,-358537222),u=a(u,f,o,s,e[3],16,-722521979),s=a(s,u,f,o,e[6],23,76029189),o=a(o,s,u,f,e[9],4,-640364487),f=a(f,o,s,u,e[12],11,-421815835),u=a(u,f,o,s,e[15],16,530742520),s=a(s,u,f,o,e[2],23,-995338651),o=i(o,s,u,f,e[0],6,-198630844),f=i(f,o,s,u,e[7],10,1126891415),u=i(u,f,o,s,e[14],15,-1416354905),s=i(s,u,f,o,e[5],21,-57434055),o=i(o,s,u,f,e[12],6,1700485571),f=i(f,o,s,u,e[3],10,-1894986606),u=i(u,f,o,s,e[10],15,-1051523),s=i(s,u,f,o,e[1],21,-2054922799),o=i(o,s,u,f,e[8],6,1873313359),f=i(f,o,s,u,e[15],10,-30611744),u=i(u,f,o,s,e[6],15,-1560198380),s=i(s,u,f,o,e[13],21,1309151649),o=i(o,s,u,f,e[4],6,-145523070),f=i(f,o,s,u,e[11],10,-1120210379),u=i(u,f,o,s,e[2],15,718787259),s=i(s,u,f,o,e[9],21,-343485551),t[0]=S(o,t[0]),t[1]=S(s,t[1]),t[2]=S(u,t[2]),t[3]=S(f,t[3])}function s(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function u(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return n}function f(t){var e,n,r,a,i,u,f=t.length,l=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=f;e+=64)o(l,s(t.substring(e-64,e)));for(t=t.substring(e-64),n=t.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<n;e+=1)r[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(o(l,r),e=0;e<16;e+=1)r[e]=0;return a=8*f,a=a.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(a[2],16),u=parseInt(a[1],16)||0,r[14]=i,r[15]=u,o(l,r),l}function l(t){var e,n,r,a,i,s,f=t.length,l=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=f;e+=64)o(l,u(t.subarray(e-64,e)));for(t=e-64<f?t.subarray(e-64):new Uint8Array(0),n=t.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<n;e+=1)r[e>>2]|=t[e]<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(o(l,r),e=0;e<16;e+=1)r[e]=0;return a=8*f,a=a.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(a[2],16),s=parseInt(a[1],16)||0,r[14]=i,r[15]=s,o(l,r),l}function c(t){var e,n="";for(e=0;e<4;e+=1)n+=b[t>>8*e+4&15]+b[t>>8*e&15];return n}function p(t){var e;for(e=0;e<t.length;e+=1)t[e]=c(t[e]);return t.join("")}function d(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function h(t,e){var n,r=t.length,a=new ArrayBuffer(r),i=new Uint8Array(a);for(n=0;n<r;n+=1)i[n]=t.charCodeAt(n);return e?i:a}function v(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function y(t,e,n){var r=new Uint8Array(t.byteLength+e.byteLength);return r.set(new Uint8Array(t)),r.set(new Uint8Array(e),t.byteLength),n?r:r.buffer}function g(t){var e,n=[],r=t.length;for(e=0;e<r-1;e+=2)n.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,n)}function m(){this.reset()}var S=function(t,e){return t+e&4294967295},b=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==p(f("hello"))&&(S=function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(t,e){return t=0|t||0,t<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(n,r){var a,i,o,s,u=this.byteLength,f=e(n,u),l=u;return r!==t&&(l=e(r,u)),f>l?new ArrayBuffer(0):(a=l-f,i=new ArrayBuffer(a),o=new Uint8Array(i),s=new Uint8Array(this,f,a),o.set(s),i)}}(),m.prototype.append=function(t){return this.appendBinary(d(t)),this},m.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,n=this._buff.length;for(e=64;e<=n;e+=64)o(this._hash,s(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},m.prototype.end=function(t){var e,n,r=this._buff,a=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<a;e+=1)i[e>>2]|=r.charCodeAt(e)<<(e%4<<3);return this._finish(i,a),n=p(this._hash),t&&(n=g(n)),this.reset(),n},m.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},m.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},m.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},m.prototype._finish=function(t,e){var n,r,a,i=e;if(t[i>>2]|=128<<(i%4<<3),i>55)for(o(this._hash,t),i=0;i<16;i+=1)t[i]=0;n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(n[2],16),a=parseInt(n[1],16)||0,t[14]=r,t[15]=a,o(this._hash,t)},m.hash=function(t,e){return m.hashBinary(d(t),e)},m.hashBinary=function(t,e){var n=f(t),r=p(n);return e?g(r):r},m.ArrayBuffer=function(){this.reset()},m.ArrayBuffer.prototype.append=function(t){var e,n=y(this._buff.buffer,t,!0),r=n.length;for(this._length+=t.byteLength,e=64;e<=r;e+=64)o(this._hash,u(n.subarray(e-64,e)));return this._buff=e-64<r?new Uint8Array(n.buffer.slice(e-64)):new Uint8Array(0),this},m.ArrayBuffer.prototype.end=function(t){var e,n,r=this._buff,a=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<a;e+=1)i[e>>2]|=r[e]<<(e%4<<3);return this._finish(i,a),n=p(this._hash),t&&(n=g(n)),this.reset(),n},m.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.ArrayBuffer.prototype.getState=function(){var t=m.prototype.getState.call(this);return t.buff=v(t.buff),t},m.ArrayBuffer.prototype.setState=function(t){return t.buff=h(t.buff,!0),m.prototype.setState.call(this,t)},m.ArrayBuffer.prototype.destroy=m.prototype.destroy,m.ArrayBuffer.prototype._finish=m.prototype._finish,m.ArrayBuffer.hash=function(t,e){var n=l(new Uint8Array(t)),r=p(n);return e?g(r):r},m}),function(t){function e(e,n){var c=this;c.uploadStatus={READY:r,READING:a,PROCESSING:i,COMPLETE:o,FAST:s,SKIP:u,CANCEL:f,ERROR:l},c.uid=e.uid||"",c.token=e.token||"",c.url=e.url||"",c.fastQueryUrl=e.fastQueryUrl||"",c.createTaskUrl=e.createTaskUrl||"",c.view=e.view||"",c.target=e.target,c.auto=!1,c.batch=!1,c.html5=!0,c.multiple=h.defaultValue(e.multiple,!0),c.upName=e.upName||"file",c.allowsMap=h.splitToMap(e.allows),c.chunkSize=e.chunkSize||5242880,c.isSliceSize=e.isSliceSize||31457280,c.isQueryState=e.isQueryState||!0,c.isMd5=e.isMd5||!0,c.isLog=e.isLog||!1,c.logBox=e.logBox,c.createUI=n.createUI||function(t){console.log(t)},c.updateUI=n.updateUI||function(t){console.log(t)},c.response=n.response||function(t){console.log(t)},c.options=e,c.list=[],c.map={},c.index=0,c.started=!1,c.init=function(){this.browserDetect()},c.initWidget=function(){c.resetInput()},c.resetInput=function(){var t=this,e=t.target;t.multiple&&e.setAttribute("multiple","multiple"),h.addEvent(e,"change",function(e){t.addFiles(this)})},c.browserDetect=function(){var e=t.XMLHttpRequest;if(!(e&&(new e).upload&&t.FormData&&t.SparkMD5&&t.File))return console.warn("请使用现代浏览器");console.info("OK"),c.initWidget()},c.init()}var n=0,r=0,a=1,i=2,o=3,s=4,u=-1,f=-2,l=-3,c={status_ready:"等待上传",status_reading:"读取中",status_processing:"上传中",status_complete:"已完成",status_fast:"秒传",status_skip:"已跳过",status_cancel:"已取消",status_error:"已失败"},p=new SparkMD5.ArrayBuffer,d=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice;e.prototype={constructor:e,uploadStatusTips:function(t){var e=c;switch(t){case r:return e.status_ready;case a:return e.status_reading;case i:return e.status_processing;case o:return e.status_complete;case s:return e.status_fast;case u:return e.status_skip;case f:return e.status_cancel;case l:return e.status_error}return t},Md5:function(t,e,n){function r(){var e=s*a.chunkSize,n=e+a.chunkSize>=i?i:e+a.chunkSize;u.readAsArrayBuffer(d.call(t.file,e,n))}var a=this,i=t.file.size,o=Math.ceil(i/a.chunkSize),s=0,u=new FileReader,f=Date.now();t.fr=u,p.reset(),u.onload=function(t){p.append(t.target.result),s++,n&&n(s/o),s<o?r():e&&e(p.end(),Date.now()-f)},u.onabort=function(){a.log(t.name+": 文件分析中断!")},u.onerror=function(){a.log(t.name+": 文件分析错误!")},r()},fileTypeSizeCheck:function(t){var e=this;if(t.ext=h.cutString(t.name,".").toLowerCase(),e.allowsMap)var n=!e.allowsMap[t.ext];if(t.state=n?u:r,n&&(t.disabled=!0),t.disabled){var a="";for(var i in e.allowsMap)a+=i+" ";return void e.tipsInfo("允许上传的文件格式为："+a)}return t.isSlice=t.size>e.isSliceSize,!0},getTask:function(t){var e=this;if(void 0!=t)return e.map[t]},clearTask:function(t){for(var e=this,n=0;n<e.list.length;n++)if(e.list[n].state==a||e.list[n].state==i)return e.tipsInfo("文件正在上传中，请等待取消或者完成后切换..."),void(t&&t(!1));e.list=[],e.map={},t&&t(!0)},setAllows:function(t){this.allowsMap=h.splitToMap(t)},createInterface:function(t){var e=this;e.createUI(t),e.updateInterface(t)},updateInterface:function(t){this.updateUI(t)},addFiles:function(t){var e=this;if("INPUT"==t.tagName){var n=t.files;if(n){for(var r=0,a=n.length;r<a;r++)e.addTask(t,n[r]);e.target.value=""}else e.addTask(t)}else e.addTask(void 0,t)},addTask:function(t,e){var r=this;if(t||e){var a,i,o;e?(a=e.name||e.fileName,i=e.size||e.fileSize,o=h.formatSize(i)):(a=h.cutString(t.value,"\\").slice(1)||t.value,i=-1);var s={id:++n,name:a,size:i,sizeFm:o,input:t,file:e};if(r.fileTypeSizeCheck(s))return s.index=r.list.length,r.list.push(s),r.map[s.id]=s,r.createInterface(s),r.auto&&r.start(),s}},cancel:function(t,e){var n=this;if(t){var o=t.state;if(o!=r&&o!=a&&o!=i)return n;if(o==a){var s=t.fr;s&&s.abort()}if(o==i){var u=t.xhr;u&&u.abort()}return e?n:n.complete(t,f)}},complete:function(t,e,n){var r=this;return t?(void 0!=e&&(t.state=e),t.responseData=n||"",r.log(t.name+": responseData ==> "+JSON.stringify(t.responseData)||""),r.log(t.name+": "+r.uploadStatusTips(t.state)+"！"),r.response(t.responseData),r.updateInterface(t),r.list.length>0&&r.batch?r.startBatchTask():(t.index>=this.list.length-1&&r.log("全部上传完成：==============================================<br />"),r)):r},remove:function(t){var e=this;t&&(t.state!=a&&t.state!=i||this.cancel(t),t.deleted=!0,e.log(t.name+": 已删除..."))},start:function(t){var e=this,n=e.list,r=n.length;if(e.started||(e.started=!0),e.batch=!1,n.length>0)for(var a=0;a<n.length;a++)if(n[a].state==i)return e;return r<=0?e:e.upload(t)},startBatchTask:function(){var t=this,e=t.list;if(t.batch=!0,e.length>0)for(var n=0;n<e.length;n++)for(var n=0;n<e.length;n++)if(e[n].state==r)return t.upload(e[n])},upload:function(t){var e=this;return!t||t.state!=r||t.skip?e:(t.isSlice&&(t.state=a),e.html5&&t.file?e.uploadHtml5Ready(t):e.complete(t,u),e)},reUpload:function(t){var e=this;return e.html5&&t.file?e.uploadHtml5Ready(t):e.complete(t,u),e},uploadHtml5Ready:function(t){var e=this;t.state=a;var n=function(){t.state=i,t.MD5&&e.isQueryState&&t.state!=o?e.fastUploadQueryState(t):e.doUpload(t)};return function(){e.isMd5&&e.Md5?e.Md5(t,function(e,r){t.MD5=e,t.timeMD5=r,n()},function(n){t.pvg=n,e.updateUI(t)}):n()}(),e},fastUploadQueryState:function(t){var e=this,n=e.fastQueryUrl+"?uid="+e.uid+"&token="+e.token+"&md5="+t.MD5,r=new XMLHttpRequest;r.open("POST",n,!0),r.onreadystatechange=function(){if(4==r.readyState&&r.status>=200&&r.status<400){var n=JSON.parse(r.response);switch(n.ret){case"0":t.queryOK=!0,t.state=u,e.log("文件状态查询：已存在，秒传"),e.complete(t,s,n);break;case"1":e.log("文件状态查询：文件不存在，开始上传"),t.isSlice?(t.chunkStart=n.currChunk||0,e.createUploadTask(t)):e.doUpload(t);break;default:e.log("文件状态查询失败"),e.complete(t,l,n),e.log(JSON.stringify(n))}}},r.onerror=function(){e.tipsInfo("网络请求失败：请检查网络!"),e.log("网络请求失败：请检查网络")},r.setRequestHeader("Content-type","application/json");var a={uid:e.uid,fileinfo:t.MD5};return r.send(JSON.stringify(a)),e},createUploadTask:function(t){var e=this,n=e.createTaskUrl,r=new XMLHttpRequest;r.open("POST",n,!0),r.onreadystatechange=function(){if(4==r.readyState&&r.status>=200&&r.status<400){var n=JSON.parse(r.response);t.alreadySlice=n.currChunk||0,e.doUpload(t)}},r.onerror=function(){};var a={name:t.name,size:t.size,chunkSize:e.chunkSize,ext:t.ext,md5:t.MD5};return r.send(JSON.stringify(a)),e},doUpload:function(t){var e=this;t.state!=o&&(t.isSlice?e.uploadSlice(t):e.uploadHtml5(t))},uploadHtml5:function(t){var e=this,n=new XMLHttpRequest,r=e.url+"?uid="+e.uid+"&token="+e.token+"&md5="+t.MD5;t.xhr=n,n.upload.addEventListener("progress",function(n){e.progress(t,n.total,n.loaded)},!1),n.addEventListener("load",function(n){e.complete(t,o,n.target.responseText)},!1),n.addEventListener("error",function(){e.complete(t,l)},!1),n.addEventListener("abort",function(){e.complete(t,f)},!1);var a=new FormData;a.append(e.upName,t.blob||t.file),n.open("POST",r,!0),n.send(a),e.afterSend(t)},uploadSlice:function(t){var e,n=this,r=t.blob||t.file,a=r.size,i=n.chunkSize,o=t.alreadySlice*n.chunkSize||0;t.sliceCount=Math.ceil(a/i);var s=function(r,i){var s=new XMLHttpRequest,u=n.url+"?uid="+n.uid+"&token="+n.token+"&md5="+t.MD5,f=e==a;t.xhr=s,s.open("POST",u),s.upload.addEventListener("progress",function(e){n.progress(t,a,o+e.loaded)},!1),s.addEventListener("load",function(e){var r=JSON.parse(e.target.responseText);switch(r.ret){case"0":n.log("该分片上传成功"),0==r.ret&&f?n.complete(t,n.uploadStatus.COMPLETE,e.target.responseText):i&&i();break;default:n.complete(t,n.uploadStatus.ERROR,e.target.responseText),n.log(t.sliceIndex+"分片上传失败")}},!1),s.addEventListener("error",function(){n.complete(t,n.uploadStatus.ERROR)},!1);var l=new FormData;l.append(n.upName,r),s.send(l)},u=function(){if(!(o>=a)){e=o+i,e>a&&(e=a),t.sliceStart=o,t.sliceEnd=e,t.sliceIndex=Math.ceil(e/i),n.log(t.name+": 上传分片 "+t.sliceIndex+" / "+t.sliceCount);var u=d.call(r,o,e);s(u,f)}},f=function(){o=e,u()};u(),n.afterSend(t)},afterSend:function(t){var e=this;t.lastTime=t.startTime=Date.now(),e.progress(t)},progress:function(t,e,n){var a=this;e||(e=t.size),(!n||n<0)&&(n=0);var u=t.state||r;n>e&&(n=e),n>0&&u==r&&(t.state=u=i),(u==o||u==s)&&(e=n=t.size),a.setTaskSpeed(t,e,n),t.total=e,t.loaded=n,t.loadedFm=h.formatSize(n),a.updateInterface(t)},setTaskSpeed:function(t,e,n){if(e&&!(e<=0)){var r,a=Date.now();if(n>=e)return t.queryOK&&(t.startTime=a),r=a-t.startTime,r?(t.avgSpeed=Math.min(Math.round(1e3*e/r),e),t.avgSpeedFm=h.formatSize(t.avgSpeed)):t.speed||(t.avgSpeed=t.speed=e,t.avgSpeedFm=h.formatSize(t.avgSpeed)),t.time=r||0,void(t.endTime=a);r=a-t.lastTime,r<200||(t.loaded||(t.loaded=0),t.speed=Math.min(Math.round(1e3*(n-t.loaded)/r),t.total),t.speedFm=h.formatSize(t.speed),t.lastTime=a)}},tipsInfo:function(t){var e=document.getElementById("upload-info");e.innerHTML=void 0!=t?t:"",e.style.display="block",h.addEvent(e,"click",function(){e.style.display="none"})},log:function(t){var e=this;if(e.isLog&&void 0!=e.logBox){e.logBox.innerHTML+=(void 0!=t?t:"")+"<br />"}else e.isLog&&void 0==e.logBox&&console.info(void 0!=t?t:"")}};var h={};h.defaultValue=function(t,e){return void 0!==t?t:e},h.isUInt=function(t){return"number"==typeof t&&t>0&&t===Math.floor(t)},h.cutString=function(t,e){var n=t.lastIndexOf(e);return-1!=n?t.slice(n):""},h.splitToMap=function(t){if(t){for(var e=t.split(","),n={},r=0;r<e.length;r++)n[e[r]]=!0;return n}},h.addClass=function(t,e){h.hasClass(t,e)||(t.className+=" "+e)},h.hasClass=function(t,e){return!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},h.removeClass=function(t,e){hasClass(t,e)&&(t.className=t.className.replace(new RegExp("(\\s|^)"+e+"(\\s|$)")," "))},document.addEventListener?(h.addEvent=function(t,e,n){t.addEventListener(e,n,!1)},h.removeEvent=function(t,e,n){t.removeEventListener(e,n,!1)}):document.attachEvent&&(h.addEvent=function(t,e,n){t.attachEvent("on"+e,n)},h.removeEvent=function(t,e,n){t.detachEvent("on"+e,n)}),h.parseLevel=function(t,e,n){t=+t,e=e||1024;for(var r=0,a="number"==typeof e,i=1,o=h.isUInt(n)?n:a?100:e.length;t>=i&&r<o;)i*=a?e:e[r],r++;return r&&t<i&&(i/=a?e:e.last(),r--),{value:r?t/i:t,level:r}};var v=["B","KB","MB","GB","TB","PB","EB"];h.formatSize=function(t,e){if(e=!0===e?{all:!0}:e||{},isNaN(t)||void 0==t||t<0){var n=e.error||"--";return e.all?{text:n}:n}var r=h.parseLevel(t,e.steps,e.limit),a=r.value,i=a.toFixed(h.defaultValue(e.digit,2));return!1!==e.trim&&-1!=i.lastIndexOf(".")&&(i=i.replace(/\.?0+$/,"")),r.text=i+(e.join||"")+(e.units||v)[r.level+(e.start||0)],e.all?r:r.text},t.Uploader=e}(window);